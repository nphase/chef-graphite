[cache]
LOG_UPDATES = False
MAX_CACHE_SIZE = inf
MAX_UPDATES_PER_SECOND = 1000
MAX_CREATES_PER_MINUTE = 50
USE_FLOW_CONTROL = True
USER = <%= @user %>
WHISPER_AUTOFLUSH = False

<%- @caches.each do |c| -%>
[cache:<%= c.name %>]
LINE_RECEIVER_INTERFACE = <%= c.listen_on %>
LINE_RECEIVER_PORT = <%= c.port %>
PICKLE_RECEIVER_INTERFACE = <%= c.listen_on %>
PICKLE_RECEIVER_PORT = <%= c.pickle_port %>
CACHE_QUERY_INTERFACE = <%= c.listen_on %>
CACHE_QUERY_PORT = <%= c.query_port %>
<%- end -%>

[relay]
MAX_DATAPOINTS_PER_MESSAGE = 500
MAX_QUEUE_SIZE = 10000
RELAY_METHOD = rules
REPLICATION_FACTOR = 1
USE_FLOW_CONTROL = True
<%- unless @relays.empty? -%>

  <%- @relays.each do |r| -%>
[relay:<%= r.name %>]
LINE_RECEIVER_INTERFACE = <%= r.listen_on %>
LINE_RECEIVER_PORT = <%= r.port %>
PICKLE_RECEIVER_INTERFACE = <%= r.listen_on %>
PICKLE_RECEIVER_PORT = <%= r.pickle_port %>
  <%- end -%>

DESTINATIONS = <%= @caches.each { |c| "#{ c.listen_on }:#{ c.pickle_port }:#{ c.name }" }.join(', ') %>
<%- end -%>
